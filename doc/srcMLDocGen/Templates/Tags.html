{% extends "Skeleton.html" %}
{% load DjangoHelpers %}
{% block cssLinks %}
    <link rel="stylesheet" href="Style/DocPageStyle.css" />
    <link rel="stylesheet" href="Style/srcMLElementsPageStyle.css" />
{% endblock %}
{%block body %}
<div id="content">
    <h2>{{doc.title}}</h2>
    {% if doc.desc != "" %}
    <hr/>
    <div class="descDisplay">
    <p class="pageDesc">{{doc.desc|safe}}</p>
    </div>
    {%endif %}

    <div id="ToCDiv">
        <div id="ToCDiv">
            <table class="ToC">
                <thead class="subheader">
                    <tr>
                        <th class="categoryRow">Namespaces</th>
                    </tr>
                </thead>
                <tbody>
                {% for nsEntry in doc.namespaces %}
                    <tr>
                        <td><a href="#ns_{{nsEntry.prefix}}">{{nsEntry.prefix}}</a></td>
                    </tr>
                {% endfor %}
                </tbody>
                <thead class="subheader">
                    <tr>
                        <th class="categoryRow">{{doc.relaxNGHelp.title}}</th>
                    </tr>
                </thead>
                <tbody>
                {% for rnEntry in doc.relaxNGHelp.entries %}
                    <tr>
                        <td><a href="#RN_{{rnEntry.link}}">{{rnEntry.title}}</a></td>
                    </tr>
                {% endfor %}
                </tbody>
                <thead class="subheader">
                    <tr>
                        <th class="categoryRow">srcML Elements</th>
                    </tr>
                </thead>
                <tbody>
                {% for tagInfo in doc.tags %}
                    <tr>
                        <td><a href="#tag_{{tagInfo.link}}">{{tagInfo.comparableTagName}}</a></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div id="namespaceContent" class="contentDisplay">
        {% for nsEntry in doc.namespaces %}
        <div class="displayedDocDefinition">
            <h2 class="title"><a id="ns_{{nsEntry.prefix}}">{{nsEntry.prefix}}&nbsp;(<span class="nsURL">{{nsEntry.url}}</span>)</a></h2>
            <hr/>
            <p class="description">{{nsEntry.desc|safe}}</p>
        </div>
        {% endfor %}
    </div>

    <div id="relaxNGGrammarHelpContent" class="displayedDocDefinition contentDisplay">
        <h2 class="title"><a id="RelaxNGHelp"></a>{{doc.relaxNGHelp.title}}</title></h2>
        <hr/>
        {% if doc.relaxNGHelp.desc != "" %}
        <div class="description">{{doc.relaxNGHelp.desc|safe}}</div>
        {% endif %}

        <div class="RELAXNGEntry">
        {% for rnEntry in doc.relaxNGHelp.entries %}
                <h3 class="title"><a id="RN_{{rnEntry.link}}"></a>{{rnEntry.title}}</h3>
                <pre class="sourceCodeExample">{{rnEntry.grammarText|safe}}</pre>
                <p>{{rnEntry.desc|safe}}</p>
        {% endfor %}
        </div>
    </div>

    <div id="srcMLTagContent" class="contentDisplay">
    {% for tagInfo in doc.tags %}
        <div class="displayedDocDefinition">
            <h2 class="title"><a id="tag_{{tagInfo.link}}"></a>{{tagInfo.comparableTagName}}</h2>
            <hr/>
            {% if tagInfo.desc != "" %} 
            <p>{{tagInfo.desc|safe}}</p>
            {% endif %}
            
            <br/>
            <div class="nsPrefix"><span class="note">Namespace:</span> <a href="#ns_{{tagInfo.ns}}">{{tagInfo.ns}}</a></div>
            <br/>
            
            <!-- Consider re-adding this later if it looks better with it then without <h3 class="title">Use Cases</h3> -->
            {% for useCase in tagInfo.useCases %}
            <div class="useCase">
                <h3 class="title">{{useCase.title}}</h3>
                
                {% if useCase.desc != "" %} 
                <p>{{useCase.desc|safe}}</p>
                {% endif %}
                <table class="languageTable">
                    <thead>
                        <tr>
                        {% for lang in doc.languages %}
                            <th>{{lang|strip}}</th>
                        {%endfor%}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                        {% for lang in doc.languages %}
                            <td>{% if lang|isIn:useCase.languages %}X{% else %}&nbsp;{% endif %}</td>
                        {% endfor%}
                        </tr>
                    </tbody>
                </table>
                <br/>
                <h4 class="title">grammar</h4>
                <pre class="sourceCodeExample">{{useCase.grammar}}</pre>
                {% if useCase.attrs|length %}
                    <!-- Create a table here that basically contains all attributes, a simple description, and what languages they occur within. -->
                    <table class="attrTable">
                        <thead>
                            <tr>
                                <th colspan="{{doc.languages|length|add:2}}">Attributes</th>
                            </tr>
                            <tr>
                                <th>Name</th>
                                <th>Value Description</th>
                            {% for lang in doc.languages %}
                                <th>{{lang}}</th>
                            {%endfor%}
                            </tr>
                        </thead>
                        <tbody>
                            {% for attr in useCase.attrs %}
                            <tr>
                                <td><code>{{attr.name}}</code></td>
                                <td>{{attr.valueDesc}}</td>
                                {% for lang in doc.languages %}
                                    <td>{% if lang|isIn:attr.languages %}X{% else %}&nbsp;{% endif %}</td>
                                {% endfor%}
                            </tr>
                            {%endfor%}
                        </tbody>

                    </table>
                {%endif%}
            </div>
            {% endfor %}
            {% if tagInfo.parentElements|length > 0 %}
            <div class="elementDisplay">
                <h3 class="title">Parent Elements</h3>
                <ul>
                    {% for parentElem in tagInfo.parentElements %}
                    <li><a href="#tag_{{parentElem.link}}">{{parentElem.comparableTagName}}</a></li>
                    {% endfor %}
                </ul>

            </div>
            {% endif %}

            {% if tagInfo.subelements|length %}
            <div class="elementDisplay">
                <h3 class="title">Subelements</h3>
                <ul>
                    {% for subElem in tagInfo.subelements %}
                    <li><a href="#tag_{{subElem.link}}">{{subElem.comparableTagName}}</a></li>
                    {% endfor %}
                </ul>

            </div>
            {% endif %}

            {% if tagInfo.refs|length %}
            <div class="elementDisplay">
                <h3 class="title">Also See</h3>
                <ul>
                    {% for ref in tagInfo.refs %}
                    <li><a href="{{ref.url}}">{{ref.title}}</a></li>
                    {% endfor %}
                </ul>

            </div>
            {% endif %}


        </div>
    {% endfor %}
    </div>
</div>
{% endblock %}
